import{_ as e}from"./plugin-vue_export-helper-DlAUqK2U.js";import{c as t,f as n,a,o as l}from"./app-KOUU_Wij.js";const r={},s=a('<h1 id="espnet2-asr-transducer-rnnt-multi-blank-utils-cuda-utils-gpu-rnnt-kernel-compute-multiblank-grad-kernel" tabindex="-1"><a class="header-anchor" href="#espnet2-asr-transducer-rnnt-multi-blank-utils-cuda-utils-gpu-rnnt-kernel-compute-multiblank-grad-kernel"><span>espnet2.asr.transducer.rnnt_multi_blank.utils.cuda_utils.gpu_rnnt_kernel.compute_multiblank_grad_kernel</span></a></h1><div class="custom-h3"><p>espnet2.asr.transducer.rnnt_multi_blank.utils.cuda_utils.gpu_rnnt_kernel.compute_multiblank_grad_kernel<span class="small-bracket">(grads: Tensor, acts: Tensor, denom: Tensor, sigma: float, alphas: Tensor, betas: Tensor, logll: Tensor, xlen: Tensor, ylen: Tensor, mlabels: Tensor, minibatch: int, maxT: int, maxU: int, alphabet_size: int, blank_: int, big_blank_duration: Tensor, num_big_blanks: int, fastemit_lambda: float, clamp: float)</span></p></div><p>Compute gradients for multi-blank transducer loss</p><p>(<a href="https://arxiv.org/pdf/2211.03541" target="_blank" rel="noopener noreferrer">https://arxiv.org/pdf/2211.03541</a>).</p><ul><li><strong>Parameters:</strong><ul><li><strong>grads</strong> – Zero Tensor of shape [B, T, U, V + 1 + num_big_blanks]. Is updated by this kernel to contain the gradients of this batch of samples.</li><li><strong>acts</strong> – Tensor of shape [B, T, U, V + 1 + num_big_blanks] flattened. Represents the logprobs activation tensor.</li><li><strong>denom</strong> – Tensor of shape [B, T, U] flattened. Represents the denominator of the logprobs activation tensor across entire vocabulary.</li><li><strong>sigma</strong> – Hyper-parameter for logit-undernormalization technique for training multi-blank transducers.</li><li><strong>alphas</strong> – Alpha variable, contains forward probabilities. A tensor of shape [B, T, U].</li><li><strong>betas</strong> – Beta varoable, contains backward probabilities. A tensor of shape [B, T, U].</li><li><strong>logll</strong> – Log-likelihood of the forward variable, represented as a vector of shape [B]. Represents the log-likelihood of the forward pass.</li><li><strong>xlen</strong> – Vector of length B which contains the actual acoustic sequence lengths in the padded activation tensor.</li><li><strong>ylen</strong> – Vector of length B which contains the actual target sequence lengths in the padded activation tensor.</li><li><strong>mlabels</strong> – Matrix of shape [B, U+1] (+1 here is due to &lt;SOS&gt; token <ul><li>usually the RNNT blank). The matrix contains the padded target transcription that must be predicted.</li></ul></li><li><strong>minibatch</strong> – Int representing the batch size.</li><li><strong>maxT</strong> – The maximum possible acoustic sequence length. Represents T in the logprobs tensor.</li><li><strong>maxU</strong> – The maximum possible target sequence length. Represents U in the logprobs tensor.</li><li><strong>alphabet_size</strong> – The vocabulary dimension V+1 (inclusive of RNNT blank).</li><li><strong>blank</strong> – Index of the RNNT blank token in the vocabulary. Generally the first or last token in the vocab.</li><li><strong>fastemit_lambda</strong> – Float scaling factor for FastEmit regularization. Refer to FastEmit: Low-latency Streaming ASR with Sequence-level Emission Regularization.</li><li><strong>clamp</strong> – Float value. When set to value &gt;= 0.0, will clamp the gradient to [-clamp, clamp].</li><li><strong>big_blank_durations</strong> – Vector of supported big blank durations of the model.</li><li><strong>num_big_blanks</strong> – Number of big blanks of the model.</li></ul></li></ul><p>Updates: : Kernel inplace updates the following inputs:</p><ul><li>grads: Gradients with respect to the log likelihood (logll).</li></ul>',7);function i(o,u){return l(),t("div",null,[n(" _espnet2.asr.transducer.rnnt_multi_blank.utils.cuda_utils.gpu_rnnt_kernel.compute_multiblank_grad_kernel "),s])}const p=e(r,[["render",i],["__file","compute_multiblank_grad_kernel.html.vue"]]),m=JSON.parse('{"path":"/guide/espnet2/asr/compute_multiblank_grad_kernel.html","title":"espnet2.asr.transducer.rnnt_multi_blank.utils.cuda_utils.gpu_rnnt_kernel.compute_multiblank_grad_kernel","lang":"en-US","frontmatter":{},"headers":[],"git":{"createdTime":null,"updatedTime":null,"contributors":[]},"readingTime":{"minutes":1.29,"words":388},"filePathRelative":"guide/espnet2/asr/compute_multiblank_grad_kernel.md","excerpt":"<!-- _espnet2.asr.transducer.rnnt_multi_blank.utils.cuda_utils.gpu_rnnt_kernel.compute_multiblank_grad_kernel -->\\n<h1>espnet2.asr.transducer.rnnt_multi_blank.utils.cuda_utils.gpu_rnnt_kernel.compute_multiblank_grad_kernel</h1>\\n<div class=\\"custom-h3\\"><p>espnet2.asr.transducer.rnnt_multi_blank.utils.cuda_utils.gpu_rnnt_kernel.compute_multiblank_grad_kernel<span class=\\"small-bracket\\">(grads: Tensor, acts: Tensor, denom: Tensor, sigma: float, alphas: Tensor, betas: Tensor, logll: Tensor, xlen: Tensor, ylen: Tensor, mlabels: Tensor, minibatch: int, maxT: int, maxU: int, alphabet_size: int, blank_: int, big_blank_duration: Tensor, num_big_blanks: int, fastemit_lambda: float, clamp: float)</span></p></div>"}');export{p as comp,m as data};
